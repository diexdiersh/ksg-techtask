
# KSG Tech Task

- [KSG Tech Task](#ksg-tech-task)
  - [Описание](#описание)
  - [Документация](#документация)
  - [Настройка](#настройка)
    - [1. Клонирование репозитория](#1-клонирование-репозитория)
    - [2. Установка зависимостей](#2-установка-зависимостей)
    - [3. Настройка переменных окружения](#3-настройка-переменных-окружения)
    - [4. Сборка приложения](#4-сборка-приложения)
    - [5. Миграции базы данных](#5-миграции-базы-данных)
      - [a. Применение миграций](#a-применение-миграций)
      - [b. Откат миграций](#b-откат-миграций)
    - [6. Запуск приложения](#6-запуск-приложения)
      - [a. Запуск в dev режиме](#a-запуск-в-dev-режиме)
      - [b. Запуск скомпилированного приложения](#b-запуск-скомпилированного-приложения)
    - [7. Настройка Docker](#7-настройка-docker)
      - [a. Запуск инфраструктурных сервисов с использованием Docker](#a-запуск-инфраструктурных-сервисов-с-использованием-docker)
      - [b. Запуск приложения с использованием Docker](#b-запуск-приложения-с-использованием-docker)
    - [8. Тестирование](#8-тестирование)
    - [9. Форматирование кода](#9-форматирование-кода)

## Описание

Этот проект представляет собой Node.js приложение, созданное с использованием Fastify и TypeScript.
Web server предоставляет REST API для управления пользователями и предметами, включая операции регистрации, депозита и покупки.
Приложение использует Redis и PostgreSQL для хранения данных, а также Swagger для документирования и тестирования API.

## Документация

- [API](API.md)

## Настройка

### 1. Клонирование репозитория

Сначала клонируйте репозиторий на ваш локальный компьютер:

```sh
git clone https://github.com/diexdiersh/ksg-techtask.git
cd ksg-techtask
```

### 2. Установка зависимостей

Установите необходимые зависимости для Node.js:

```sh
npm install
```

### 3. Настройка переменных окружения

Создайте файл .env в корневом каталоге проекта. Этот файл должен содержать необходимые переменные окружения для вашего приложения.

```sh
cp .env.example .env
```

### 4. Сборка приложения

Для сборки выполните:

```sh
npm run build
```

Эта команда очистит предыдущие сборки и скомпилирует исходный код.

### 5. Миграции базы данных

Для управления миграциями в базе данных используется собственный менеджер миграций.

#### a. Применение миграций

Для применения последних миграций к базе данных выполните команду:

```sh
npm run migrate:up
```

#### b. Откат миграций

Для отката последней примененных миграции выполните команду:

```sh
npm run migrate:down
```

### 6. Запуск приложения

#### a. Запуск в dev режиме

Для запуска приложения в dev режиме с поддержкой перезагрузки используйте команду:

```sh
npm run start:dev
```

#### b. Запуск скомпилированного приложения

Для запуска скомпилированное приложения выполните команду:

```sh
npm run start
```

Это запустит скомпилированное приложение из каталога dist/.

### 7. Настройка Docker

Проект включает конфигурации Docker Compose для упрощения настройки окружения разработки и инфраструктуры.

#### a. Запуск инфраструктурных сервисов с использованием Docker

Для запуска только инфраструктурных сервисов (PostgreSQL, Redis) выполните команду:

```sh
npm run docker:infra:up
```

Для остановки и удаления контейнеров инфраструктуры выполните команду:

```sh
npm run docker:infra:down
```

#### b. Запуск приложения с использованием Docker

Для запуска приложения в dev режиме внутри контейнера выполните команду:

```sh
npm run docker:dev:up
```

Для остановки и удаления контейнера приложения выполните команду:

```sh
npm run docker:dev:down
```

Просмотр логов запущенного контейнера:

```sh
npm run docker:dev:logs
```

### 8. Тестирование

Для запуска тестов выполните команду:

```sh
npm run test
```

Эта команда запустит тесты с использованием Jest.

### 9. Форматирование кода

Для форматирования кода выполните командк:

```sh
npm run lint
```

Для автоматического исправления ошибок линтинга:

```sh
npm run fix
```
